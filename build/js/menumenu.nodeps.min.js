var menumenu=function(M){"use strict";return function(e,u){var l=document.querySelector(e),s=l.querySelectorAll("li"),n=l.querySelectorAll("li > ul"),a=M.animationEndEvent();if(l&&s.length&&n.length){(u=M.merge({addBackLink:!0,addDropdownToggle:!0,classBackLink:"back-link",classDropdownToggle:"dropdown-toggle",classHasChildren:"has-children",classMenuHidden:"menu-hidden",classSubMenu:"sub-menu",closeOnOutsideClick:!0,idMenu:"menumenu",msgBack:"Back"},u)).classMenuIn="menu-in",u.classMenuOut="menu-out",u.classSubMenuIn="sub-menu-in",u.classSubMenuOut="sub-menu-out",u.classSubMenuHidden="sub-menu-hidden",u.classSubMenuShown="sub-menu-shown",l.id||(l.id=u.idMenu),M.addClasses(l,"menumenu"),M.forEach(s,function(e,s){e.id||(e.id=l.id+"-item-"+(s+1))}),M.forEach(n,function(e){if(M.addClasses(e,u.classSubMenu+" "+u.classSubMenuHidden),u.addDropdownToggle){var s='<span class="'+u.classDropdownToggle+' generated"></span>';e.insertAdjacentHTML("beforebegin",s)}if(u.addBackLink){var n='<li class="'+u.classBackLink+'"><a href="#">'+u.msgBack+"</a></li>";e.insertAdjacentHTML("afterbegin",n)}var a=M.getClosest(e,"li");e.dataset.id=a.id,M.addClasses(a,u.classHasChildren)});var c=!1,d=l.querySelectorAll("."+u.classDropdownToggle);M.forEach(d,function(n){n.dataset.id=M.getClosest(n,"li").id,n.dataset.depth=M.getParents(n,"li > ul").length;var e='ul[data-id="'+n.dataset.id+'"]',a=l.querySelector(e);M.on(n,"click",function(e){e.preventDefault();var s=l.querySelector("."+u.classSubMenuShown);s?"0"===n.dataset.depth&&!1===c?f(s,t):f(s,function(){r(a)}):i(function(){r(a)}),c=!1})});var o=l.querySelectorAll("."+u.classBackLink);M.forEach(o,function(a){var e=M.getParents(a,"#"+l.id+" li")[1];a.dataset.id=e?e.id:"none",M.on(a,"click",function(e){e.preventDefault();var s=l.querySelector("."+u.classSubMenuShown);if("none"===a.dataset.id)f(s,t);else{var n="."+u.classDropdownToggle+'[data-id="'+a.dataset.id+'"]';c=!0,l.querySelector(n).click()}})});var t=function(){M.addClasses(l,u.classMenuIn),M.removeClasses(l,u.classMenuHidden),M.removeClasses(l,u.classMenuOut)},i=function(e,s){M.addClasses(l,u.classMenuOut),M.addClasses(l,u.classMenuHidden),M.removeClasses(l,u.classMenuIn),u.closeOnOutsideClick&&S(l),"function"==typeof e&&e.call(s)},r=function(e){M.addClasses(e,u.classSubMenuIn);var n=function(e,s){M.off(e,s.type,n),M.removeClasses(e,u.classSubMenuHidden),M.addClasses(e,u.classSubMenuShown)}.bind(e,e);M.on(e,a,n)},f=function(e,s,n){M.addClasses(e,u.classSubMenuOut),M.removeClasses(e,u.classSubMenuIn);var l=function(e,s,n,a){M.off(e,a.type,l),M.addClasses(e,u.classSubMenuHidden),M.removeClasses(e,u.classSubMenuShown),M.removeClasses(e,u.classSubMenuOut),"function"==typeof s&&s.call(n)}.bind(e,e,s,n);M.on(e,a,l)},S=function(a){M.on(document,"click",function e(s){if(!a.contains(s.target)){var n=a.querySelector("."+u.classSubMenuShown);n&&(console.log("HIT!"),M.off(document,"click",e),f(n,t))}})}}}}(dominoob);
